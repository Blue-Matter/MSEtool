% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllNewClasses.R
\docType{class}
\name{Spatial}
\alias{Spatial}
\alias{Spatial<-}
\title{Spatial Object}
\usage{
Spatial(
  UnfishedDist = NULL,
  ProbStaying = NULL,
  RelativeSize = NULL,
  Movement = NULL,
  FracOther = NULL,
  CVDist = 0.1,
  CVStay = 1,
  Misc = list()
)

Spatial(x) <- value
}
\arguments{
\item{UnfishedDist}{Numeric or numeric array. The relative distribution of the stock over areas.
See \code{Details}.}

\item{ProbStaying}{Numeric or numeric array. The probability of remaining in an area in a given time step. See \code{Details}.#'}

\item{RelativeSize}{Numeric or numeric array. The relative size of each area. See \code{RelativeSize} in \code{Details}.}

\item{Movement}{A numeric matrix or array. See \code{Movement} in \code{Details}.}

\item{FracOther}{See \verb{More than Two Areas} in \code{Details}.}

\item{CVDist}{The logit CV associated with \code{UnfishedDist} (used as a penalty when optimizing for \code{UnfishedDist}). See \code{?FitMovement} for details.}

\item{CVStay}{The logit CV associated with \code{ProbStaying} (used as a penalty when optimizing for diagonal (\code{ProbStaying})). See \code{?FitMovement} for details.}

\item{Misc}{A list for additional miscellaneous objects. Not currently used.}

\item{x}{A \code{\link[=Stock]{Stock()}} object}

\item{value}{A \code{spatial} object to assign to \code{x}}

\item{Arrangement}{A numeric matrix with the layout ofthe areas. Used for plotting only.}
}
\description{
The \code{Spatial} function is used to create S4 class \code{spatial} objects or to
access or assign \code{spatial} objects to \code{\link[=Stock]{Stock()}} class objects
}
\details{
\subsection{About the \code{spatial} Class}{

Objects of class \code{spatial} contain information relating to spatial distribution
and movement of the stock.

\code{Spatial} is only required for spatial operating models. Leave it empty for non-spatial models.
}

\subsection{Creating New Objects}{

New \code{spatial} objects can be created with \code{Spatial()}, see \code{Usage} and \code{Examples} for details.
}

\subsection{Accessing and Assigning Slots}{

Like all of the new style objects in \code{MSEtool}, the slots in \code{spatial} objects can be accessed and assigned with functions matching the slot names. See \verb{See Also} section for functions.
}

\subsection{Two Area}{

For operating models with 2 spatial areas, \code{UnfishedDist} and \code{ProbStaying}
represent the the fraction of the unfished biomass and the probability of remaining
in Area 1 respectively.

The fraction of unfished biomass in Area 2 is \code{1-UnfishedDist}. The probability
of remaining in Area 2 is calculated by an optimization routine
that solves for the specified fraction in Area 1 and the probability of remaining
in Area 1.

\code{UnfishedDist} and \code{ProbStaying} can be one of the following:
\enumerate{
\item \strong{Numeric length 1}: Constant across all simulations and age classes;
\item \strong{Numeric length 2}: Lower and upper bounds of a uniform distribution;
\item \strong{Numeric 3D array}: Dimensions \code{c(nSim, nArea, nAge)}. Movement by age.
Must sum to 1 across areas for each simulation and age class.
\item \strong{Numeric 4D array}: Dimensions \code{c(nSim, nArea, nAge, nTS)}. Movement by age and time step.
Must sum to 1 across areas for each simulation, age class, and time step.
}
}

\subsection{More than Two Areas}{

For operating models with more than 2 spatial areas, \code{UnfishedDist} must be a
numeric array with at least 2 dimensions: \code{nsim} and \code{nArea}. It must sum to 1
across areas.

Add additional dimensions for movement by age (\code{c(nSim, nArea, nAge)}) and
by age and time step (\code{c(nSim, nArea, nAge, nTS)}).

With the exception of \code{nArea}, each dimension can either be length 1 or length corresponding
to the number of simulations, number of age class, and total number of time steps
respectively for \code{nSim}, \code{nAge}, and \code{nTS}.

\code{ProbStaying} is the desired probability of staying within each area. The optimization
routine solves \code{ProbStaying} to find the movement matrix that is closted to the
specified unfished distribution (\code{UnfishedDist}; see \code{?FitMovement} for details).

\code{FracOther} is required for models with more than 2 areas. It must be a numeric
array with at least dimensions \code{c(nSim, nArea, nArea)}, with option for \code{nAge}
and \code{nTS} dimensions as described above.

The diagonal values of \code{FracOther} (within each simulation, age class, and time step)
represent the probability of remaining in an area and therefore should be set to \code{NA},
as \code{ProbStaying} is solved as described above.

The off-diagonal values represent, for each row, the relative probability of
moving from Area in row and column \code{i} to Area in row \code{i} and column \code{j}.
}

\subsection{RelativeSize}{

\code{RelativeSize} is used for calculating the density of biomass in each area.

For 2 area models, \code{RelativeSize} is the relative size of Area 1. IT should
either be a single numeric value, a numeric vector length 2 reperesenting the
lower and upper bounds of a uniform distribution, or a numeric vector of length \code{nSim}.

For more than 2 areas, \code{RelativeSize} should be a numeric vector length \code{nArea},
or a numeric matrix with dimensions \code{nSim} by \code{nArea}.

If \code{RelativeSize} is not specified, all areas are assumed to be the same size.
}

\subsection{Movement}{

\code{Movement} is calculated internally from \code{UnfishedDist} and \code{ProbStaying}. If it is
provided, the asymptotic unfished distribution will be calculated and assigned
to \code{UnfishedDist} (over-writing any values that are in \code{UnfishedDist}).

\code{Movement} is a numeric array  with dimensions \code{nSim}, \code{nArea}, \code{nArea}, \code{nAge}, and
\code{nTS}, with each element containing the probability of moving from the first area
dimension (row in an \code{nArea} by \code{nArea} matrix) to the second area (column in an \code{nArea} by \code{nArea} matrix).
The last two dimensions \code{nAge} and \code{nTS} are optional.
}
}
\section{Functions}{
\itemize{
\item \code{Spatial()}: Create a new \code{spatial} class object

\item \code{Spatial(x) <- value}: Assign a \code{spatial} class object to a \code{\link[=Stock]{Stock()}} object

}}
\section{Slots}{

\describe{
\item{\code{UnfishedDist}}{Numeric or numeric array. The relative distribution of the stock over areas.
See \code{Details}.}

\item{\code{ProbStaying}}{Numeric or numeric array. The probability of remaining in an area in a given time step. See \code{Details}.#'}

\item{\code{RelativeSize}}{Numeric or numeric array. The relative size of each area. See \code{RelativeSize} in \code{Details}.}

\item{\code{Movement}}{A numeric matrix or array. See \code{Movement} in \code{Details}.}

\item{\code{FracOther}}{See \verb{More than Two Areas} in \code{Details}.}

\item{\code{Arrangement}}{A numeric matrix with the layout ofthe areas. Used for plotting only.}

\item{\code{CVDist}}{The logit CV associated with \code{UnfishedDist} (used as a penalty when optimizing for \code{UnfishedDist}). See \code{?FitMovement} for details.}

\item{\code{CVStay}}{The logit CV associated with \code{ProbStaying} (used as a penalty when optimizing for diagonal (\code{ProbStaying})). See \code{?FitMovement} for details.}

\item{\code{Misc}}{A list for additional miscellaneous objects. Not currently used.}
}}

\examples{


# Two Area
Spatial <- Spatial(UnfishedDist=0.3, # Fraction Unfished in Area 1
                   ProbStaying=0.6,
                   RelativeSize=0.8)

# Populate the object (usually done internally; see `?Populate`)
Spatial <- Populate(Spatial)

UnfishedDist(Spatial) # Spatial distribution
Movement(Spatial) # Movement matrix
RelativeSize(Spatial)

# Two Area - stochastic
Spatial <- Spatial(UnfishedDist=c(0.1, 0.3),
                   ProbStaying=c(0.8, 0.9),
                   RelativeSize=c(0.2,0.4))

# Populate the object (usually done internally; see `?Populate`)
Spatial <- Populate(Spatial, nsim=5)

plot(Spatial)

UnfishedDist(Spatial)
Movement(Spatial)
RelativeSize(Spatial)


# Two Area - Movement by Age
nsim <- 1
Ages <- Ages(5)
nage <- nAge(Ages)

# assume linear movement to Area 2 with age
UnfishedDist <- array(NA, dim=c(nsim, 2, nage))
MoveTo2 <- seq(0.1, to=0.9, length.out=nage)
for (a in 1:nage) {
  UnfishedDist[,,a] <- c(1-MoveTo2[a], MoveTo2[a])
}

Spatial <- Spatial(UnfishedDist=UnfishedDist,
                   ProbStaying=0.95)

Spatial <- Populate(Spatial, nsim=nsim)


plot(Spatial)

# Asymptotic Distribution
UnfishedDist(Spatial)[1,,,1]

# Movement matrix - Age - 0
Movement(Spatial)[1,,,1,]

# Movement matrix - Age 5
Movement(Spatial)[1,,,6,]

# Three Area Model
narea <- 3
UnfishedDist <- matrix(c(0.5, 0.2, 0.3), nrow=1, ncol=narea)


# the relative fraction moving from one area to the others
FracOther <- array(NA, dim=c(1, narea, narea))
FracOther[1,1,] <- c(NA, 1, 0.1) # movement in to Area 3 is 10\% of movement into Area 2
FracOther[1,2,] <- c(1, NA, 1)
FracOther[1,3,] <- c(0.1, 1, NA) # movement in to Area 1 is 10\% of movement into Area 2

Spatial <- Spatial(UnfishedDist=UnfishedDist,
                   ProbStaying=c(0.9, 0.2,0.9), # initial values for prob. staying
                   FracOther=FracOther,
                   RelativeSize=c(0.1, 0.4, 0.5))

Spatial <- Populate(Spatial)

UnfishedDist(Spatial)[1,,,]
Movement(Spatial)[1,,,,]
RelativeSize(Spatial)



# Three Area movement by Age
nsim <- 1
narea <- 3
nage <- nAge(Ages(5))

# Movement from Area 1 to Area 3 with increasing age
UnfishedDist <- array(NA, dim=c(nsim, narea, nage))
UnfishedDist[,,1] <- c(0.95, 0.045, 0.005)
UnfishedDist[,,2] <- c(0.75, 0.20, 0.05)
UnfishedDist[,,3] <- c(0.5, 0.4, 0.1)
UnfishedDist[,,4] <- c(0.3, 0.5, 0.2)
UnfishedDist[,,5] <- c(0.1, 0.5, 0.4)
UnfishedDist[,,6] <- c(0.01, 0.2, 0.79)

# the relative fraction moving from one area to the others
FracOther <- array(NA, dim=c(nsim, narea, narea))
FracOther[1,1,] <- c(NA, 1, 0.1) # movement in to Area 3 is 10\% of movement into Area 2
FracOther[1,2,] <- c(1, NA, 1)
FracOther[1,3,] <- c(0.1, 1, NA) # movement in to Area 1 is 10\% of movement into Area 2

Spatial <- Spatial(UnfishedDist=UnfishedDist,
                          ProbStaying=0.05,
                          FracOther=FracOther)

Spatial <- Populate(Spatial)

# Asymptotic Distribution
UnfishedDist(Spatial)[1,,,]

# Movement matrix - Age 0
Movement(Spatial)[1,,,1,]

# Movement matrix - Age 5
Movement(Spatial)[1,,,6,]




}
\seealso{
\code{\link[=UnfishedDist]{UnfishedDist()}}, \code{\link[=ProbStaying]{ProbStaying()}}, \code{\link[=RelativeSize]{RelativeSize()}}, \code{\link[=Movement]{Movement()}}, \code{\link[=FracOther]{FracOther()}}, \code{\link[=Arrangement]{Arrangement()}}, \code{\link[=CVDist]{CVDist()}}, \code{\link[=CVStay]{CVStay()}}, \code{\link[=Misc]{Misc()}}, \code{\link[=CalcMovement]{CalcMovement()}}, \code{\link[=Check]{Check()}}
}
